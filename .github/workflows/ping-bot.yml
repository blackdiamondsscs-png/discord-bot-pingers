name: ü§ñ Discord Bot Pinger 24/7

on:
  schedule:
    # –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
    - cron: '*/5 * * * *'
  
  # –†–∞–∑—Ä–µ—à–∏—Ç—å —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
  workflow_dispatch:

jobs:
  ping-bot:
    runs-on: ubuntu-latest
    
    steps:
    - name: üöÄ –ü–∏–Ω–≥ Discord –±–æ—Ç–∞
      run: |
        echo "=== –ó–ê–ü–£–°–ö –ê–í–¢–û–ù–û–ú–ù–û–ì–û –ü–ò–ù–ì–ï–†–ê ==="
        echo "üïê –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞: $(date '+%Y-%m-%d %H:%M:%S')"
        echo ""
        
        # === –ó–ê–ú–ï–ù–ò –≠–¢–£ –°–¢–†–û–ö–£ –ù–ê –°–í–û–ô URL ===
        BOT_URL="https://python-blackdiamond6.replit.app"
        
        echo "üéØ –¶–µ–ª—å: $BOT_URL"
        echo "üîß –ü—Ä–æ–≤–µ—Ä—è—é URL..."
        echo ""
        
        # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∏–Ω–≥–∞ —Å –¥–µ—Ç–∞–ª—è–º–∏
        ping_and_log() {
          local url="$1"
          local attempt="$2"
          
          echo "üîÑ –ü–æ–ø—ã—Ç–∫–∞ #$attempt: $url"
          
          # –ü–∏–Ω–≥ —Å —Ç–∞–π–º–∞—É—Ç–æ–º 10 —Å–µ–∫—É–Ω–¥
          start_time=$(date +%s)
          http_code=$(curl -s -o /dev/null -w "%{http_code}" --max-time 10 "$url")
          end_time=$(date +%s)
          response_time=$((end_time - start_time))
          
          if [ "$http_code" = "200" ]; then
            echo "‚úÖ –£–°–ü–ï–•! –°—Ç–∞—Ç—É—Å: $http_code, –í—Ä–µ–º—è: ${response_time}—Å"
            return 0
          else
            echo "‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê! –°—Ç–∞—Ç—É—Å: $http_code, –í—Ä–µ–º—è: ${response_time}—Å"
            
            # –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
            if [ "$attempt" -eq 1 ]; then
              # –ü—Ä–æ–±—É–µ–º —Å / –Ω–∞ –∫–æ–Ω—Ü–µ
              ping_and_log "${url}/" 2
            elif [ "$attempt" -eq 2 ]; then
              # –ü—Ä–æ–±—É–µ–º http –≤–º–µ—Å—Ç–æ https
              ping_and_log "${url/https/http}" 3
            fi
            
            return 1
          fi
        }
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –ø–∏–Ω–≥
        echo "üì° –ù–∞—á–∏–Ω–∞—é –ø–∏–Ω–≥..."
        ping_and_log "$BOT_URL" 1
        
        echo ""
        echo "=== –†–ï–ó–£–õ–¨–¢–ê–¢–´ ==="
        echo "‚úÖ GitHub Actions —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–≤–æ–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö"
        echo "‚è∞ –°–ª–µ–¥—É—é—â–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∏–Ω–≥ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç"
        echo "üîß –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç, 24/7"
        echo "üåê –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–≤–æ–µ–≥–æ –ü–ö –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
        echo ""
        echo "üïê –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: $(date '+%H:%M:%S')"
        
    - name: üìä –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥
      if: always()
      run: |
        echo "üìÖ –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: $(date)"
        echo "‚úÖ Workflow –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ"
